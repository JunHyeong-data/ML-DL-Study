# Chapter 3. Conditional Probability & Bayes' Rule
조건부 확률과 베이즈 정리

---

## 1. 조건부 확률 (Conditional Probability)
<img width="1606" height="819" alt="image" src="https://github.com/user-attachments/assets/0dc352cb-5b0c-457c-b4d0-df0cd5e14857" />

### 1.1 개념
- 어떤 사건 B가 **이미 일어났다는 조건 하에서**
- 사건 A가 일어날 확률

표기:
```math
P(A \mid B)
````

의미:

> “B가 발생했을 때, A가 발생할 확률”

---

### 1.2 정의 (가장 중요)

```math
P(A \mid B) = \frac{P(A \cap B)}{P(B)}, \quad P(B) > 0
```

* 분자: A와 B가 **동시에 발생**
* 분모: 조건이 되는 사건 B

---

### 1.3 해석 포인트

* 조건부 확률에서 **중요한 건 앞(A)**
* 뒤(B)는 이미 **주어진 정보**

---

## 2. 조건부 확률의 성질
<img width="1622" height="868" alt="image" src="https://github.com/user-attachments/assets/9b9c99f3-4af9-42c2-a60a-d2594d650068" />

### 2.1 서로 배반인 경우

* A와 B가 서로 배반 → ( A \cap B = \emptyset )

```math
P(A \mid B) = 0
```

---

### 2.2 포함 관계

* A ⊂ B 인 경우

```math
P(A \mid B) = \frac{P(A)}{P(B)}
```

---

## 3. 예제 1: 취업 상태와 성별
<img width="1554" height="1033" alt="image" src="https://github.com/user-attachments/assets/b9834c61-1c49-4ddc-8eed-f0057407ee82" />

### 3.1 데이터

|    | 취업  | 미취업 | 합계  |
| -- | --- | --- | --- |
| 남성 | 460 | 40  | 500 |
| 여성 | 140 | 260 | 400 |
| 합계 | 600 | 300 | 900 |

---

### 3.2 문제

> **미취업자라는 조건 하에 남성일 확률은?**

---

### 3.3 풀이

```math
P(\text{남성} \mid \text{미취업})
= \frac{P(\text{남성} \cap \text{미취업})}{P(\text{미취업})}
= \frac{40}{300}
= \frac{2}{15}
```

---

## 4. 예제 2: 공 색깔과 상태
<img width="1601" height="1039" alt="image" src="https://github.com/user-attachments/assets/ba0ee042-a383-4261-adcb-ccf78249facf" />

### 4.1 상황

* 총 150개 공
* 빨간 공: 96개
* 파란 공: 54개
* 빨간 공 중 빛나는 공: 36개

---

### 4.2 문제

> 빨간 공이라는 조건 하에 빛나는 공일 확률은?

---

### 4.3 풀이

```math
P(\text{Shiny} \mid \text{Red})
= \frac{36}{96}
= \frac{3}{8}
```

---

### 4.4 보완

* 같은 조건에서 **칙칙한 공 확률**

```math
= 1 - \frac{3}{8} = \frac{5}{8}
```

---

## 5. 표본공간 기반 예제 (동전 2회)
<img width="1638" height="1035" alt="image" src="https://github.com/user-attachments/assets/d8700935-e577-4ea8-8341-3dca458c1532" />

### 5.1 표본공간

```math
S = \{HH, HT, TH, TT\}
```

---

### 5.2 이벤트 정의

* A: 두 번 모두 앞면 → {HH}
* B: 첫 번째가 앞면 → {HH, HT}
* C: 적어도 하나 앞면 → {HH, HT, TH}

---

### 5.3 문제 1

> 첫 번째가 앞면이라는 조건 하에 두 번 다 앞면일 확률

```math
P(A \mid B) = \frac{1}{2}
```

---

### 5.4 문제 2

> 적어도 하나 앞면이라는 조건 하에 두 번 다 앞면일 확률

```math
P(A \mid C) = \frac{1}{3}
```

---

## 6. 곱셈 법칙 (Multiplication Rule)
<img width="1637" height="1032" alt="image" src="https://github.com/user-attachments/assets/ee55cd6b-9c30-4e81-85b5-bdb135eaed29" />
<img width="1550" height="1054" alt="image" src="https://github.com/user-attachments/assets/4310856e-ca59-41d1-a75f-dfb8061adc93" />

### 6.1 기본 형태

```math
P(A \cap B) = P(A \mid B)P(B) = P(B \mid A)P(A)
```

---

### 6.2 확장 (3개 사건)

```math
P(A \cap B \cap C)
= P(A)P(B \mid A)P(C \mid A \cap B)
```

---

### 6.3 일반화

```math
P(A_1 \cap A_2 \cap \cdots \cap A_k)
= P(A_1)
\prod_{i=2}^k P(A_i \mid A_1 \cap \cdots \cap A_{i-1})
```

---

## 7. 전체 확률의 법칙 (Law of Total Probability)
<img width="1651" height="1128" alt="image" src="https://github.com/user-attachments/assets/e3cf457f-b09a-4e73-8c01-5acea9d28099" />

### 7.1 조건

* ( A_1, A_2, \dots, A_n )은

  * 서로 배반
  * 전체 표본공간 분할

---

### 7.2 공식

```math
P(B) = \sum_{i=1}^n P(B \mid A_i)P(A_i)
```

---

## 8. 베이즈 정리 (Bayes' Rule)
<img width="1506" height="1045" alt="image" src="https://github.com/user-attachments/assets/b8443acc-d0c1-41e6-b572-e16a6825543a" />

### 8.1 공식

```math
P(A_i \mid B)
= \frac{P(B \mid A_i)P(A_i)}
{\sum_{j=1}^n P(B \mid A_j)P(A_j)}
```

---

### 8.2 용어 정리
<img width="1542" height="1016" alt="image" src="https://github.com/user-attachments/assets/51d857ab-5efa-43f3-afb5-23421b1590bd" />

| 항목       | 의미               |
| -------- | ---------------- |
| P(A)     | 사전확률 (Prior)     |
| P(B | A) | 우도 (Likelihood)  |
| P(A | B) | 사후확률 (Posterior) |
| P(B)     | 정규화 상수           |

---

## 9. 베이즈 예제 1: 타이어 불량
<img width="1607" height="1029" alt="image" src="https://github.com/user-attachments/assets/4eb7731b-5908-4803-8ba2-64f2d4ab9fde" />
<img width="1566" height="1066" alt="image" src="https://github.com/user-attachments/assets/fe7b2be3-faf8-4f2c-a56f-0028cc52473d" />

### 9.1 정보

* 공급자 1: 40%, 불량률 10%
* 공급자 2: 60%, 불량률 5%

---

### 9.2 문제

> 불량 타이어가 공급자 1에서 왔을 확률은?

---

### 9.3 풀이

```math
P(S_1 \mid D)
= \frac{0.1 \times 0.4}
{0.1 \times 0.4 + 0.05 \times 0.6}
= \frac{0.04}{0.07}
\approx 0.571
```

---

## 10. 베이즈 예제 2: 질병 검사
<img width="1600" height="1044" alt="image" src="https://github.com/user-attachments/assets/a1b0618f-a9c4-4b56-9439-8c354a79588f" />
<img width="1653" height="1048" alt="image" src="https://github.com/user-attachments/assets/9f186bf7-075a-4355-8b23-9224fdf0e21c" />
<img width="1611" height="1067" alt="image" src="https://github.com/user-attachments/assets/e70ea904-cb75-457f-8f44-2b1e7702e14c" />
<img width="1654" height="1129" alt="image" src="https://github.com/user-attachments/assets/9aeb8485-c8f4-4424-aa18-daeab0aac808" />

### 10.1 정보

* 유병률: 1%
* 민감도: 97%
* 위양성률: 6%

---

### 10.2 문제

> 검사 양성일 때 실제 질병일 확률은?

---

### 10.3 핵심

* **양성 ≠ 질병**
* 사전확률이 매우 중요

(→ 수치 계산은 연습 문제)

---

## 11. 핵심 요약

* 조건부 확률:

  > “정보가 주어졌을 때 확률을 재해석하는 도구”
* 베이즈 정리:

  > “사전확률을 데이터로 업데이트하는 공식”
* 머신러닝, 통계 추론의 **핵심 뼈대**

---
