# Chapter 3. Conditional Probability & Bayes' Rule
조건부 확률과 베이즈 정리

---

## 1. 조건부 확률 (Conditional Probability)
<img width="1528" height="768" alt="image" src="https://github.com/user-attachments/assets/45eb493b-aab1-45b9-a246-a273633df748" />

### 1.1 개념
- 어떤 사건 B가 **이미 일어났다는 조건 하에서**
- 사건 A가 일어날 확률

표기:
```math
P(A \mid B)
````

의미:

> “B가 발생했을 때, A가 발생할 확률”

---

### 1.2 정의 (가장 중요)

```math
P(A \mid B) = \frac{P(A \cap B)}{P(B)}, \quad P(B) > 0
```

* 분자: A와 B가 **동시에 발생**
* 분모: 조건이 되는 사건 B

---

### 1.3 해석 포인트

* 조건부 확률에서 **중요한 건 앞(A)**
* 뒤(B)는 이미 **주어진 정보**

---

## 2. 조건부 확률의 성질
<img width="1533" height="881" alt="image" src="https://github.com/user-attachments/assets/690bd699-ee01-47f3-93fc-dfe51baf2f42" />

### 2.1 서로 배반인 경우

* A와 B가 서로 배반 → ( A \cap B = \emptyset )

```math
P(A \mid B) = 0
```

---

### 2.2 포함 관계

* A ⊂ B 인 경우

```math
P(A \mid B) = \frac{P(A)}{P(B)}
```

---

## 3. 예제 1: 취업 상태와 성별
<img width="1542" height="1038" alt="image" src="https://github.com/user-attachments/assets/a14809fa-c5b6-4dd7-9033-3d1fe98db9a2" />

### 3.1 데이터

|    | 취업  | 미취업 | 합계  |
| -- | --- | --- | --- |
| 남성 | 460 | 40  | 500 |
| 여성 | 140 | 260 | 400 |
| 합계 | 600 | 300 | 900 |

---

### 3.2 문제

> **미취업자라는 조건 하에 남성일 확률은?**

---

### 3.3 풀이

```math
P(\text{남성} \mid \text{미취업})
= \frac{P(\text{남성} \cap \text{미취업})}{P(\text{미취업})}
= \frac{40}{300}
= \frac{2}{15}
```

---

## 4. 예제 2: 공 색깔과 상태
<img width="1568" height="1023" alt="image" src="https://github.com/user-attachments/assets/6c79e5b8-2d2e-4b65-955e-a36e8f1fb64f" />

### 4.1 상황

* 총 150개 공
* 빨간 공: 96개
* 파란 공: 54개
* 빨간 공 중 빛나는 공: 36개

---

### 4.2 문제

> 빨간 공이라는 조건 하에 빛나는 공일 확률은?

---

### 4.3 풀이

```math
P(\text{Shiny} \mid \text{Red})
= \frac{36}{96}
= \frac{3}{8}
```

---

### 4.4 보완

* 같은 조건에서 **칙칙한 공 확률**

```math
= 1 - \frac{3}{8} = \frac{5}{8}
```

---

## 5. 표본공간 기반 예제 (동전 2회)
<img width="1643" height="1121" alt="image" src="https://github.com/user-attachments/assets/2c8ff93a-14a4-4958-b286-176e35b95a66" />

### 5.1 표본공간

```math
S = \{HH, HT, TH, TT\}
```

---

### 5.2 이벤트 정의

* A: 두 번 모두 앞면 → {HH}
* B: 첫 번째가 앞면 → {HH, HT}
* C: 적어도 하나 앞면 → {HH, HT, TH}

---

### 5.3 문제 1

> 첫 번째가 앞면이라는 조건 하에 두 번 다 앞면일 확률

```math
P(A \mid B) = \frac{1}{2}
```

---

### 5.4 문제 2

> 적어도 하나 앞면이라는 조건 하에 두 번 다 앞면일 확률

```math
P(A \mid C) = \frac{1}{3}
```

---

## 6. 곱셈 법칙 (Multiplication Rule)
<img width="1579" height="1006" alt="image" src="https://github.com/user-attachments/assets/24735e72-edf0-4f5b-9a02-c3c37370dcbf" />

### 6.1 기본 형태

```math
P(A \cap B) = P(A \mid B)P(B) = P(B \mid A)P(A)
```

---

### 6.2 확장 (3개 사건)

```math
P(A \cap B \cap C)
= P(A)P(B \mid A)P(C \mid A \cap B)
```

---

### 6.3 일반화

```math
P(A_1 \cap A_2 \cap \cdots \cap A_k)
= P(A_1)
\prod_{i=2}^k P(A_i \mid A_1 \cap \cdots \cap A_{i-1})
```

---

## 7. 전체 확률의 법칙 (Law of Total Probability)
<img width="1623" height="1107" alt="image" src="https://github.com/user-attachments/assets/c7600b05-675e-4ea3-894b-c9ef49ebed91" />

### 7.1 조건

* ( A_1, A_2, \dots, A_n )은

  * 서로 배반
  * 전체 표본공간 분할

---

### 7.2 공식

```math
P(B) = \sum_{i=1}^n P(B \mid A_i)P(A_i)
```

---

## 8. 베이즈 정리 (Bayes' Rule)
<img width="1611" height="1119" alt="image" src="https://github.com/user-attachments/assets/6241e9a2-22b6-411d-94de-1c377132da3e" />

### 8.1 공식

```math
P(A_i \mid B)
= \frac{P(B \mid A_i)P(A_i)}
{\sum_{j=1}^n P(B \mid A_j)P(A_j)}
```

---

### 8.2 용어 정리
<img width="1609" height="1009" alt="image" src="https://github.com/user-attachments/assets/e1a1839c-a7f5-4218-8924-d60d0f097589" />

| 항목       | 의미               |
| -------- | ---------------- |
| P(A)     | 사전확률 (Prior)     |
| P(B | A) | 우도 (Likelihood)  |
| P(A | B) | 사후확률 (Posterior) |
| P(B)     | 정규화 상수           |

---

## 9. 베이즈 예제 1: 타이어 불량
<img width="1602" height="1003" alt="image" src="https://github.com/user-attachments/assets/748a4369-25ef-464f-80b2-7cdd19ed8681" />
<img width="1633" height="1119" alt="image" src="https://github.com/user-attachments/assets/2a41dc34-a633-4bc2-905f-8c5c66649a66" />

### 9.1 정보

* 공급자 1: 40%, 불량률 10%
* 공급자 2: 60%, 불량률 5%

---

### 9.2 문제

> 불량 타이어가 공급자 1에서 왔을 확률은?

---

### 9.3 풀이

```math
P(S_1 \mid D)
= \frac{0.1 \times 0.4}
{0.1 \times 0.4 + 0.05 \times 0.6}
= \frac{0.04}{0.07}
\approx 0.571
```

---

## 10. 베이즈 예제 2: 질병 검사
<img width="1617" height="1030" alt="image" src="https://github.com/user-attachments/assets/8db8aef5-5a98-486c-8783-b24a4c4c4810" />
<img width="1630" height="1124" alt="image" src="https://github.com/user-attachments/assets/b67daef5-9ef2-4c7c-9f32-d39618e89ab1" />
<img width="1620" height="1114" alt="image" src="https://github.com/user-attachments/assets/2ac9f993-4058-445a-91f2-e6e78f0893cb" />
<img width="1631" height="1123" alt="image" src="https://github.com/user-attachments/assets/93a3695d-fbc6-41ef-8eda-ad6b1e90eeb1" />

### 10.1 정보

* 유병률: 1%
* 민감도: 97%
* 위양성률: 6%

---

### 10.2 문제

> 검사 양성일 때 실제 질병일 확률은?

---

### 10.3 핵심

* **양성 ≠ 질병**
* 사전확률이 매우 중요

(→ 수치 계산은 연습 문제)

---

## 11. 핵심 요약

* 조건부 확률:

  > “정보가 주어졌을 때 확률을 재해석하는 도구”
* 베이즈 정리:

  > “사전확률을 데이터로 업데이트하는 공식”
* 머신러닝, 통계 추론의 **핵심 뼈대**

---
