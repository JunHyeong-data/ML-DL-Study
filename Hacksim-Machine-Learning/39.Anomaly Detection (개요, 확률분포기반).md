# 이상치 탐지 (Anomaly Detection) — Part 1  
## 개념 정리 및 밀도 기반 접근법 입문

---

## 1. 강의 개요

- 본 강의는 **이상치 탐지(Anomaly Detection)**를 주제로 진행됨
- 전체 강의는 크게 **3개의 파트**로 구성
  - Part 1: 개념 정리 및 직관
  - Part 2: 대표 알고리즘
  - Part 3: 신경망 기반 접근
- 본 문서는 **Part 1 (약 40분 분량)** 내용을 정리한 자료임

---

## 2. 이상치 관련 용어 정리

우리는 다음과 같은 영어 용어들을 자주 접함:

- **Novelty**
- **Anomaly**
- **Outlier**

하지만 한국어로는 대부분 **‘이상치’** 하나로 번역되어 혼란이 발생함.  
이 세 개는 비슷하지만 **의미와 쓰임에 중요한 차이**가 있음.

---

## 3. Novelty / Anomaly / Outlier의 개념적 차이

### 3.1 Novelty (노벨티)
<img width="1180" height="837" alt="image" src="https://github.com/user-attachments/assets/e6bd754e-8fe0-46cd-82bd-9473190849b9" />

- 의미: **새로움**, **긍정적 변화**
- 기존 데이터와 **본질적으로는 같지만**, 보기 드문 형태
- 분석 대상이 될 수 있으며 **제거하면 안 됨**

📌 예시 (호랑이 비유):
- 일반적인 백두산 호랑이 → 정상
- **백호(White Tiger)** → Novelty  
  - 돌연변이이지만 여전히 ‘호랑이’
  - 희귀하고 주목할 가치 있음

---

### 3.2 Anomaly (애노멀리)
<img width="1251" height="921" alt="image" src="https://github.com/user-attachments/assets/61711b5d-1f25-4740-8259-d6bde83c7f90" />

- Novelty와 매우 유사하지만 **약간 부정적인 뉘앙스**
- 기존 패턴에서 벗어난 **비정상적인 행동**
- **탐지의 대상**이며, 분석 목적에 따라 중요할 수 있음

📌 예시:
- **라이거(Liger)**  
  - 사자 + 호랑이
  - 새로운 개체지만 본질적으로 다름
  - 분석 대상이 될 수 있음

---

### 3.3 Outlier (아웃라이어)
<img width="1249" height="875" alt="image" src="https://github.com/user-attachments/assets/ee99f5d0-953d-48ea-9371-c19bd85b49da" />

- 가장 **부정적인 의미**
- 정상 데이터와 **완전히 다른 분포**
- 분석 결과에 **심각한 왜곡을 유발**
- 보통 **탐지 후 제거 대상**

📌 예시:
- 호랑이 데이터 속에 갑자기 **사자, 토끼, 기린**이 섞여 있음

---

### 3.4 정리 요약
<img width="1347" height="848" alt="image" src="https://github.com/user-attachments/assets/e3292e97-75ca-4f32-a609-5876aea21ea1" />

| 구분 | 의미 | 분석 대상 | 처리 방식 |
|----|----|----|----|
| Novelty | 긍정적 새로움 | O | 유지 |
| Anomaly | 비정상 패턴 | O | 유지 |
| Outlier | 완전히 다른 값 | X | 제거 |

> ⚠️ 한국어로 모두 ‘이상치’라 번역되지만, 실제 분석에서는 **구분이 매우 중요**

---

## 4. Anomaly Detection의 기본 전제

### 4.1 데이터 불균형 (Severe Imbalance)
<img width="1354" height="927" alt="image" src="https://github.com/user-attachments/assets/9aa25ad8-cbc3-4ea9-98b8-dd640cc89616" />

- 이상치는 **항상 소수**
- 보통 분포:
  - 정상: 99% 이상
  - 이상치: 1% 이하
- 경우에 따라:
  - 99.99% 정상 / 0.01% 이상
  - 이상치가 **아예 없는 경우**도 존재

---

### 4.2 지도학습이 어려운 이유
<img width="1356" height="985" alt="image" src="https://github.com/user-attachments/assets/2806be74-da3f-4ea0-9a7c-e8af9398323f" />

일반적인 이진 분류 모델을 사용하면:

- 정상 데이터에 강하게 치우친 모델 생성
- 모든 데이터를 정상으로 예측해도 **정확도는 매우 높음**
- 하지만 **현업에서는 무의미**

📌 핵심:
> “불량 5개를 잡는 것이  
> 정상 995개를 맞히는 것보다 중요하다.”

---

## 5. 이상치 탐지의 기본 전략
<img width="1346" height="963" alt="image" src="https://github.com/user-attachments/assets/01484f3b-3558-4dad-92d9-b76e4b8893bf" />
<img width="1344" height="880" alt="image" src="https://github.com/user-attachments/assets/5467cdd0-1ab6-4eaa-a760-c1c864e15e46" />

### 5.1 학습 단계

- **정상 데이터만 사용**
- 이상치 데이터는 무시하거나 존재하지 않음

### 5.2 평가 단계

- 가능한 경우:
  - 소량의 이상치 데이터로 성능 평가
  - Sensitivity(재현율)가 매우 중요

---

## 6. 이상치 탐지 vs 이진 분류
<img width="1351" height="914" alt="image" src="https://github.com/user-attachments/assets/b7511db4-4ac0-4c43-9059-1e7d0f5d02e7" />
<img width="1337" height="950" alt="image" src="https://github.com/user-attachments/assets/4ce09277-a876-4d8f-a97b-d7a9de7f9177" />
<img width="1340" height="966" alt="image" src="https://github.com/user-attachments/assets/d58d1975-bb95-425c-b13e-6550247c33de" />
<img width="1361" height="967" alt="image" src="https://github.com/user-attachments/assets/f9dd5a92-b60e-4f3a-9d2a-401ec8586f79" />

### 6.1 이진 분류 (Binary Classification)

- 클래스 정보 사용
- 정상 / 비정상 모두 학습
- 목적: 정확한 클래스 분류

---

### 6.2 이상치 탐지 (One-Class Classification)

- **정상 클래스만 사용**
- “정상인지 아닌지”만 판단
- 이상치의 **종류는 구분 불가**

📌 그래서 부르는 이름:
- One-Class Classification

---

## 7. Boundary 기반 직관

### 7.1 기본 아이디어

1. 정상 데이터만으로 **경계(boundary)** 생성
2. 새로운 데이터가:
   - 경계 안 → 정상
   - 경계 밖 → 이상치

---

### 7.2 Boundary 설정의 딜레마
<img width="1350" height="961" alt="image" src="https://github.com/user-attachments/assets/23e8c869-8874-4a8e-bf0f-0127c3bb571d" />
<img width="1344" height="917" alt="image" src="https://github.com/user-attachments/assets/6037ca1b-156c-4c14-970d-582c0ca573d8" />
<img width="1366" height="968" alt="image" src="https://github.com/user-attachments/assets/bf63aa17-3086-4da6-9d9f-27f8ed8d4cde" />

- 너무 크면:
  - 이상치 탐지 실패
- 너무 작으면:
  - False Alarm 증가

📌 실무적 해결:
- 정상 데이터의 일부(1~5%)는 **허용 오차로 경계 밖 허용**

---

## 8. 이상치 데이터가 없는 경우의 전략
<img width="1366" height="869" alt="image" src="https://github.com/user-attachments/assets/9193664f-c6cd-4bca-b722-5423657e08b4" />

### 상황
- 정상 데이터만 존재
- 이상치 데이터 전혀 없음

### 해결책

- 포기 ❌
- 정상 데이터로 모델 먼저 구축
- 평가 방법:
  - 인위적 이상치 생성
  - 향후 수집되는 데이터로 검증
  - 도메인 지식 활용

> “이상치가 없다고 분석을 멈추는 것은 연구자의 태도가 아니다.”

---

## 9. 해석 가능성 (Interpretability) 문제

- 이상치 탐지는 보통:
  - 정상 / 비정상만 판단
- 하지만 실무에서는:
  - **왜 이상치인지**
  - **어떤 변수가 원인인지**가 중요

📌 최근 연구 트렌드:
- Explainable Anomaly Detection
- 원인 분석(Post-hoc Analysis)

---

## 10. 시계열 및 센서 데이터 사례

### 예시
<img width="1347" height="943" alt="image" src="https://github.com/user-attachments/assets/534fc550-3eb7-4b62-863a-c3244d8b72f2" />
<img width="1337" height="967" alt="image" src="https://github.com/user-attachments/assets/e26149e2-f0ec-41a3-96b7-cc25e7296667" />
<img width="1348" height="967" alt="image" src="https://github.com/user-attachments/assets/9a983cce-b92c-4cd8-b9ec-4f01fd4bd3be" />
<img width="1348" height="976" alt="image" src="https://github.com/user-attachments/assets/c7150824-3768-4fe1-bc97-45096fad7121" />

- 장비 센서 데이터
- 생산 설비 모니터링
- 이메일 스팸 탐지
- 신호 데이터의 특정 구간 이상 탐지

특징:
- 단일 포인트가 아닌 **구간(Window)** 단위 판단

---

## 11. 밀도 기반 접근의 직관
<img width="1342" height="911" alt="image" src="https://github.com/user-attachments/assets/4d5e81f1-7071-45cf-b9bd-81ba82dd9b79" />
<img width="1368" height="901" alt="image" src="https://github.com/user-attachments/assets/e9a0e723-92d6-4a87-9048-7eae86377ea6" />

### 핵심 아이디어

- 정상 데이터:
  - 서로 **가깝게 모여 있음**
  - 높은 밀도
- 이상치:
  - 주변에 데이터가 없음
  - 낮은 밀도

---

## 12. 확률 분포 기반 접근

### 12.1 단일 정규분포 가정
<img width="1369" height="973" alt="image" src="https://github.com/user-attachments/assets/aec34e5e-2229-41a6-855c-c4df284a4240" />

- 정상 데이터는 높은 확률
- 이상치는 낮은 확률

하지만 현실에서는:
- 완벽한 정규분포는 거의 존재하지 않음

---

### 12.2 혼합 분포 (Gaussian Mixture)
<img width="1362" height="968" alt="image" src="https://github.com/user-attachments/assets/85c4ef57-bffe-439c-84e0-a5f3310303f5" />
<img width="1338" height="939" alt="image" src="https://github.com/user-attachments/assets/d5eebd2d-d3e4-4a1f-8457-459e5a05d6a5" />
<img width="1364" height="968" alt="image" src="https://github.com/user-attachments/assets/35a00f93-8290-469b-a20b-bf81ce3f0fb9" />

- 여러 개의 정상 군집 존재
- 각 군집은 정규분포
- 전체는 혼합 분포(GMM)

이 경우:
- 군집 중심 → 정상
- 군집 외곽 / 군집 사이 → 이상치

---

## 13. 이상치 스코어와 임계값 (Threshold)

이상치 탐지에는 반드시 두 가지가 필요:

1. **이상치 스코어**
   - 얼마나 이상한가?
2. **임계값**
   - 어느 정도면 이상치인가?

이 두 가지가:
- 객관적
- 설명 가능
- 재현 가능  
해야 알고리즘으로 인정됨

---

## 14. 정리

- 이상치 탐지는:
  - 불균형 데이터 문제
  - 지도학습이 아닌 경우가 대부분
- 정상 데이터 중심 사고가 핵심
- 밀도, 확률, 경계 개념이 기본 토대
- 이후 강의에서:
  - 밀도 기반
  - 모델 기반
  - 신경망 기반 접근으로 확장

---
